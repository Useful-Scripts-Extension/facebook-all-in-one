import{an as y,ao as R,r as n,ap as e,aq as u}from"./index-DPONv-AB.js";import{a as V,a2 as N,S as r,a3 as T,b as _}from"./MyApp-DEIUhxeN.js";import{S as I}from"./StoryViewers-BGYpRoyn.js";import{u as C}from"./useCacheState-CJv9KMn_.js";import{T as c}from"./index-DRtX_-IA.js";import{I as F}from"./index-Dcy0fSW9.js";import{A as L}from"./index-BR4Pt_VD.js";import"./Collection-K88sGWrf.js";import"./index-CRR1ljKb.js";import"./file-download-Db6M2NsT.js";import"./index-nAq8iqIJ.js";import"./Dropdown-BxPBQoTL.js";import"./PurePanel-DNavI3ZW.js";import"./index-HNqxY7iK.js";import"./TextArea-1Q1I5EX3.js";import"./addEventListener-DR_NM1NW.js";import"./index-B8GgScDR.js";import"./Pagination-2Ahrgyjg.js";import"./row-CuIGguQJ.js";import"./styleChecker-CyKTA426.js";function ee({story:i}){const{ti:d}=V(),l=y(R.profile),[s,j]=C("RecentStoryViewer.buckets."+i.bucked_id,[]),[o,p]=n.useState(0),[x,f]=n.useState(!1),[g,w]=n.useState(!1),t=s[o]||s[0],v=o<s.length-1,b=o>0,k=s.length===0&&!x,S=i.owner.id===(l==null?void 0:l.uid),h=n.useRef(!1);n.useEffect(()=>{i.bucked_id&&!h.current&&(f(!0),h.current=!0,N(i.bucked_id).then(m=>{m&&(console.log(i,m),j(m))}).finally(()=>{h.current=!1,f(!1)}))},[]);const a={height:"70vh",width:"calc(70vh * 9 / 16)",borderRadius:10,objectFit:"contain"};return e.jsxs(r,{direction:"vertical",style:{maxHeight:"100vh",overflowY:"auto",overflowX:"hidden",minWidth:a.width,minHeight:a.height,background:"#222",padding:"10px 10px 30px",borderRadius:10,color:"white"},children:[e.jsxs(c.Text,{children:["Story Viewer (",o+1,"/",s.length,")"]}),x&&e.jsxs("div",{children:[e.jsx("i",{className:"fa fa-spinner fa-spin"})," Loading..."]}),k&&e.jsx("div",{children:"No data"}),t&&e.jsxs(r,{children:[e.jsx(u,{disabled:!b,onClick:()=>{p(o-1)},children:e.jsx("i",{className:"fa fa-chevron-left"})}),e.jsxs(r,{direction:"vertical",children:[e.jsxs(c.Text,{children:[T(t.creation_time*1e3,d)," ",d({vi:"trước",en:"ago"})," - ",t.react_count," reactions"," ",t.reaction]}),S?e.jsxs(u,{type:"default",onClick:()=>w(!g),children:[e.jsx("i",{className:"fa fa-eye"})," ",t.view_count," ",d({vi:"Lượt xem",en:"Views"})]}):null,t.caption&&e.jsx(c.Text,{children:t.caption}),g?e.jsx(r,{style:{width:450,height:a.height,overflowY:"auto",overflowX:"hidden"},direction:"vertical",children:e.jsx(I,{storyId:t.id})}):e.jsxs(r,{style:{position:"relative"},children:[t.video?e.jsx("video",{controls:!0,autoPlay:!0,loop:!0,src:t.video,style:a}):e.jsx(F,{src:t.image,fallback:t.thumbnail,style:a}),e.jsx(r,{style:{background:"linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%)",position:"absolute",top:0,left:0,padding:10,width:"100%",paddingBottom:"50px",borderRadius:10},children:e.jsxs(c.Link,{target:"_blank",href:_(i.owner.id),children:[e.jsx(L,{src:i.owner.avatar,size:40,style:{borderWidth:4,borderColor:"#0866FF",marginRight:10}}),e.jsx(c.Text,{style:{color:"#eee"},children:i.owner.name})]})})]})]}),e.jsx(u,{disabled:!v,onClick:()=>{p(o+1)},children:e.jsx("i",{className:"fa fa-chevron-right"})})]})]})}export{ee as default};
