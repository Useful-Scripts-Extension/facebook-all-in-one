import{al as L,r as f,aq as h}from"./index-CyNdLPYt.js";import{a as k,q as x,w as C}from"./MyApp-LN2FQ_E9.js";import{I}from"./index-CUI78ohi.js";import"./addEventListener-DtSE-MRu.js";function q(m){const{cacheId:p,getPreview:u,renderPreview:r,...a}=m,{message:o}=L.useApp(),{ti:s}=k(),c=a.src||"",n="ImageLazyPreview."+(p||c),[y,i]=f.useState(!1),[l,d]=f.useState(x(n,"")),w=async()=>{if(!l)try{i(!0),o.loading({duration:0,key:n,content:s({en:"Loading...",vi:"Đang tải..."})});let t=performance.now();const e=await u();let v=performance.now();console.log("getPreview",v-t),e&&e!==c&&(d(e),C(n,e)),o.success({key:n,content:s({en:"Load success",vi:"Tải xong"})})}catch(t){console.error(t),o.error({key:n,content:s({en:"Load failed: ",vi:"Tải lỗi: "})+t.message})}finally{i(!1)}},g=l||c;return h.jsx(I,{...a,preview:typeof r=="function"?r(g,y):{src:g},onClick:t=>{var e;(e=a.onClick)==null||e.call(a,t),w()}})}export{q as default};
