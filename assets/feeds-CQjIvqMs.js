import{A as h,C as b,O as I,P as C,D as w,H as A}from"./MyApp-DTETyBe6.js";async function k(e="",a=""){const r=await h({fb_api_req_friendly_name:"CometSinglePostContentQuery",variables:{feedbackSource:2,feedLocation:"PERMALINK",focusCommentID:null,privacySelectorRenderLocation:"COMET_STREAM",renderLocation:"permalink",scale:2,storyID:btoa(`S:_I${e}:${a}:${a}`),useDefaultActor:!1,__relay_internal__pv__CometImmersivePhotoCanUserDisable3DMotionrelayprovider:!1,__relay_internal__pv__IsWorkUserrelayprovider:!1,__relay_internal__pv__IsMergQAPollsrelayprovider:!1,__relay_internal__pv__CometUFIReactionsEnableShortNamerelayprovider:!1,__relay_internal__pv__CometUFIShareActionMigrationrelayprovider:!0,__relay_internal__pv__IncludeCommentWithAttachmentrelayprovider:!0,__relay_internal__pv__StoriesArmadilloReplyEnabledrelayprovider:!0,__relay_internal__pv__EventCometCardImage_prefetchEventImagerelayprovider:!1},doc_id:"8457098094310209"});return JSON.parse(r.split(`
`)[0]||"{}")}async function E(e="",a=""){const r=await h({fb_api_req_friendly_name:"CometAlbumPhotoCollagePaginationQuery",variables:{cursor:a,count:14,renderLocation:"permalink",scale:2,id:btoa(`mediaset:${e}`)},doc_id:"7250936985006590"}),s=JSON.parse(r),{edges:_=[],page_info:o={}}=b(s);return _.map(i=>{var c,l,t,p,f,d,n,u;return{id:(c=i.node)==null?void 0:c.id,image:(t=(l=i.node)==null?void 0:l.image)==null?void 0:t.uri,width:(f=(p=i.node)==null?void 0:p.image)==null?void 0:f.width,height:(n=(d=i.node)==null?void 0:d.image)==null?void 0:n.height,isVideo:((u=i.node)==null?void 0:u.__isMedia)==="Video",cursor:i.cursor}})}function P(e){var o,i,c,l;let a=(o=/\/posts\/(\d+)/.exec(e))==null?void 0:o[1];if(a)return a;let r=(i=/\/posts\/(pfbid\w+)/.exec(e))==null?void 0:i[1];if(r)return v(r);if(e.includes("permalink.php?")){const t=new URLSearchParams(e.split("?")[1]);if(t.has("story_fbid")&&t.has("id"))return v(t.get("story_fbid"))}if(e.includes("multi_permalinks=")){const t=new URLSearchParams(e.split("?")[1]);if(t.has("multi_permalinks"))return t.get("multi_permalinks")}if(e.includes("/photo/")){const t=new URLSearchParams(e.split("?")[1]);if(t.has("fbid"))return t.get("fbid")}const s=(c=/\/groups\/(.*?)\/posts\/(\d+)\//.exec(e))==null?void 0:c[2];if(s)return s;const _=(l=/\/posts\/(.*?)\/(\d+)/.exec(e))==null?void 0:l[2];return _||null}async function v(e){var s;const a=await h({q:`node(${e}){id}`}),r=JSON.parse(a);return(s=Object.keys(r))==null?void 0:s[0]}async function O(e=100,a,r){var c,l,t,p,f;let _="https://graph.facebook.com/v14.0/me/posts?fields=id,reactions.limit(1000){id},comments.limit(1000){from{id}},created_time&limit=100&access_token="+await I(C.EAAB);const o=[],i=new Set;for(;;)try{const d=await w(_),n=JSON.parse(d);if(console.log(n),!Array.isArray(n==null?void 0:n.data))break;let u=!1;for(let m of n.data)i.has(m.id)||(u=!0,o.push({postId:m.id,created_time:m.created_time,reactions_uid:(l=(c=m.reactions)==null?void 0:c.data)==null?void 0:l.map(y=>y.id),comments_uid:(p=(t=m.comments)==null?void 0:t.data)==null?void 0:p.map(y=>y.from.id)}),i.add(m.id));a==null||a(o);const g=(f=n==null?void 0:n.paging)==null?void 0:f.next;if(!u||o.length>=e||g===_||r!=null&&r())break;_=g,await A(1e3)}catch(d){console.log(d);break}return console.log(o),o}export{P as a,k as b,E as c,O as g};
