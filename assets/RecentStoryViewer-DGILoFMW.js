import{ao as y,ap as R,r as n,aq as e,ar as p}from"./index-BHXKmVCz.js";import{a as V,S as o,K as N,g as T}from"./MyApp-D3s3_HYi.js";import{S as _}from"./StoryViewers-FgAISved.js";import{u as I}from"./useCacheState-qfQNn3s9.js";import{a as C}from"./stories-ByqAUfHX.js";import{T as c}from"./index-uWdICvcO.js";import{I as F}from"./index-nJNM8QwN.js";import{A as L}from"./index-91JLSMjD.js";import"./Collection-CVY6RAuW.js";import"./index-Dg4juIYI.js";import"./file-download-B61gr9qz.js";import"./index-qnrgCfZc.js";import"./Dropdown-DWNKdxI0.js";import"./PurePanel-1dmrI8F2.js";import"./index-C1WryKGC.js";import"./TextArea-HhZjAChj.js";import"./addEventListener-CT_OFR_m.js";import"./index-GzAVUdJD.js";import"./Pagination-B1Icb6rc.js";import"./useBreakpoint-D2os0tFA.js";import"./responsiveObserver-BlyeT88p.js";import"./row-QkvUEytR.js";import"./styleChecker-D0QDgsjO.js";import"./index-C5qdd6Bk.js";function oe({story:i}){const{ti:d}=V(),l=y(R.profile),[s,j]=I("RecentStoryViewer.buckets."+i.bucked_id,[]),[r,u]=n.useState(0),[f,x]=n.useState(!1),[g,w]=n.useState(!1),t=s[r]||s[0],v=r<s.length-1,b=r>0,k=s.length===0&&!f,S=i.owner.id===(l==null?void 0:l.uid),h=n.useRef(!1);n.useEffect(()=>{i.bucked_id&&!h.current&&(x(!0),h.current=!0,C(i.bucked_id).then(m=>{m&&(console.log(i,m),j(m))}).finally(()=>{h.current=!1,x(!1)}))},[]);const a={height:"70vh",width:"calc(70vh * 9 / 16)",borderRadius:10,objectFit:"contain"};return e.jsxs(o,{direction:"vertical",style:{maxHeight:"100vh",overflowY:"auto",overflowX:"hidden",minWidth:a.width,minHeight:a.height,background:"#222",padding:"10px 10px 30px",borderRadius:10,color:"white"},children:[e.jsxs(c.Text,{children:["Story Viewer (",r+1,"/",s.length,")"]}),f&&e.jsxs("div",{children:[e.jsx("i",{className:"fa fa-spinner fa-spin"})," Loading..."]}),k&&e.jsx("div",{children:"No data"}),t&&e.jsxs(o,{children:[e.jsx(p,{disabled:!b,onClick:()=>{u(r-1)},children:e.jsx("i",{className:"fa fa-chevron-left"})}),e.jsxs(o,{direction:"vertical",children:[e.jsxs(c.Text,{children:[N(t.creation_time*1e3,d)," ",d({vi:"trước",en:"ago"})," - ",t.react_count," reactions"," ",t.reaction]}),S?e.jsxs(p,{type:"default",onClick:()=>w(!g),children:[e.jsx("i",{className:"fa fa-eye"})," ",t.view_count," ",d({vi:"Lượt xem",en:"Views"})]}):null,t.caption&&e.jsx(c.Text,{children:t.caption}),g?e.jsx(o,{style:{width:450,height:a.height,overflowY:"auto",overflowX:"hidden"},direction:"vertical",children:e.jsx(_,{storyId:t.id})}):e.jsxs(o,{style:{position:"relative"},children:[t.video?e.jsx("video",{controls:!0,autoPlay:!0,loop:!0,src:t.video,style:a}):e.jsx(F,{src:t.image,fallback:t.thumbnail,style:a}),e.jsx(o,{style:{background:"linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%)",position:"absolute",top:0,left:0,padding:10,width:"100%",paddingBottom:"50px",borderRadius:10},children:e.jsxs(c.Link,{target:"_blank",href:T(i.owner.id),children:[e.jsx(L,{src:i.owner.avatar,size:40,style:{borderWidth:4,borderColor:"#0866FF",marginRight:10}}),e.jsx(c.Text,{style:{color:"#eee"},children:i.owner.name})]})})]})]}),e.jsx(p,{disabled:!v,onClick:()=>{u(r+1)},children:e.jsx("i",{className:"fa fa-chevron-right"})})]})]})}export{oe as default};
