import{r as t,E as te,F as re,H as oe,D as ne,v as se,I as _,aI as ae,a7 as X,o as M,t as ie,Q as le}from"./index-DKcwpaNn.js";import{R as ce}from"./MyApp-CDv-rFzA.js";import{r as de}from"./responsiveObserver-C2jXDk8e.js";import{a as ge}from"./useBreakpoint-SG1Oq1Ac.js";import{P as ue}from"./index-CDyKukV1.js";const B=t.createContext({}),me=e=>{const{antCls:n,componentCls:s,iconCls:r,avatarBg:l,avatarColor:z,containerSize:y,containerSizeLG:x,containerSizeSM:f,textFontSize:g,textFontSizeLG:O,textFontSizeSM:R,borderRadius:u,borderRadiusLG:m,borderRadiusSM:E,lineWidth:N,lineType:w}=e,o=(v,p,$)=>({width:v,height:v,borderRadius:"50%",[`&${s}-square`]:{borderRadius:$},[`&${s}-icon`]:{fontSize:p,[`> ${r}`]:{margin:0}}});return{[s]:Object.assign(Object.assign(Object.assign(Object.assign({},oe(e)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:z,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:l,border:`${ne(N)} ${w} transparent`,"&-image":{background:"transparent"},[`${n}-image-img`]:{display:"block"}}),o(y,g,u)),{"&-lg":Object.assign({},o(x,O,m)),"&-sm":Object.assign({},o(f,R,E)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},pe=e=>{const{componentCls:n,groupBorderColor:s,groupOverlapping:r,groupSpace:l}=e;return{[`${n}-group`]:{display:"inline-flex",[`${n}`]:{borderColor:s},"> *:not(:first-child)":{marginInlineStart:r}},[`${n}-group-popover`]:{[`${n} + ${n}`]:{marginInlineStart:l}}}},ve=e=>{const{controlHeight:n,controlHeightLG:s,controlHeightSM:r,fontSize:l,fontSizeLG:z,fontSizeXL:y,fontSizeHeading3:x,marginXS:f,marginXXS:g,colorBorderBg:O}=e;return{containerSize:n,containerSizeLG:s,containerSizeSM:r,textFontSize:Math.round((z+y)/2),textFontSizeLG:x,textFontSizeSM:l,groupSpace:g,groupOverlapping:-f,groupBorderColor:O}},q=te("Avatar",e=>{const{colorTextLightSolid:n,colorTextPlaceholder:s}=e,r=re(e,{avatarBg:s,avatarColor:n});return[me(r),pe(r)]},ve);var fe=function(e,n){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(s[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(e);l<r.length;l++)n.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(s[r[l]]=e[r[l]]);return s};const Se=(e,n)=>{const[s,r]=t.useState(1),[l,z]=t.useState(!1),[y,x]=t.useState(!0),f=t.useRef(null),g=t.useRef(null),O=se(n,f),{getPrefixCls:R,avatar:u}=t.useContext(_),m=t.useContext(B),E=()=>{if(!g.current||!f.current)return;const a=g.current.offsetWidth,i=f.current.offsetWidth;if(a!==0&&i!==0){const{gap:C=4}=e;C*2<i&&r(i-C*2<a?(i-C*2)/a:1)}};t.useEffect(()=>{z(!0)},[]),t.useEffect(()=>{x(!0),r(1)},[e.src]),t.useEffect(E,[e.gap]);const N=()=>{const{onError:a}=e;(a==null?void 0:a())!==!1&&x(!1)},{prefixCls:w,shape:o,size:v,src:p,srcSet:$,icon:b,className:T,rootClassName:F,alt:k,draggable:j,children:S,crossOrigin:I}=e,h=fe(e,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","alt","draggable","children","crossOrigin"]),c=ae(a=>{var i,C;return(C=(i=v??(m==null?void 0:m.size))!==null&&i!==void 0?i:a)!==null&&C!==void 0?C:"default"}),G=Object.keys(typeof c=="object"?c||{}:{}).some(a=>["xs","sm","md","lg","xl","xxl"].includes(a)),A=ge(G),L=t.useMemo(()=>{if(typeof c!="object")return{};const a=de.find(C=>A[C]),i=c[a];return i?{width:i,height:i,fontSize:i&&(b||S)?i/2:18}:{}},[A,c]),d=R("avatar",w),H=X(d),[Q,J,K]=q(d,H),U=M({[`${d}-lg`]:c==="large",[`${d}-sm`]:c==="small"}),V=t.isValidElement(p),Y=o||(m==null?void 0:m.shape)||"circle",Z=M(d,U,u==null?void 0:u.className,`${d}-${Y}`,{[`${d}-image`]:V||p&&y,[`${d}-icon`]:!!b},K,H,T,F,J),ee=typeof c=="number"?{width:c,height:c,fontSize:b?c/2:18}:{};let P;if(typeof p=="string"&&y)P=t.createElement("img",{src:p,draggable:j,srcSet:$,onError:N,alt:k,crossOrigin:I});else if(V)P=p;else if(b)P=b;else if(l||s!==1){const a=`scale(${s})`,i={msTransform:a,WebkitTransform:a,transform:a};P=t.createElement(ce,{onResize:E},t.createElement("span",{className:`${d}-string`,ref:g,style:Object.assign({},i)},S))}else P=t.createElement("span",{className:`${d}-string`,style:{opacity:0},ref:g},S);return delete h.onError,delete h.gap,Q(t.createElement("span",Object.assign({},h,{style:Object.assign(Object.assign(Object.assign(Object.assign({},ee),L),u==null?void 0:u.style),h.style),className:Z,ref:O}),P))},D=t.forwardRef(Se),W=e=>{const{size:n,shape:s}=t.useContext(B),r=t.useMemo(()=>({size:e.size||n,shape:e.shape||s}),[e.size,e.shape,n,s]);return t.createElement(B.Provider,{value:r},e.children)},he=e=>{var n,s,r;const{getPrefixCls:l,direction:z}=t.useContext(_),{prefixCls:y,className:x,rootClassName:f,style:g,maxCount:O,maxStyle:R,size:u,shape:m,maxPopoverPlacement:E,maxPopoverTrigger:N,children:w,max:o}=e,v=l("avatar",y),p=`${v}-group`,$=X(v),[b,T,F]=q(v,$),k=M(p,{[`${p}-rtl`]:z==="rtl"},F,$,x,f,T),j=ie(w).map((h,c)=>le(h,{key:`avatar-key-${c}`})),S=(o==null?void 0:o.count)||O,I=j.length;if(S&&S<I){const h=j.slice(0,S),c=j.slice(S,I),G=(o==null?void 0:o.style)||R,A=((n=o==null?void 0:o.popover)===null||n===void 0?void 0:n.trigger)||N||"hover",L=((s=o==null?void 0:o.popover)===null||s===void 0?void 0:s.placement)||E||"top",d=Object.assign(Object.assign({content:c},o==null?void 0:o.popover),{overlayClassName:M(`${p}-popover`,(r=o==null?void 0:o.popover)===null||r===void 0?void 0:r.overlayClassName),placement:L,trigger:A});return h.push(t.createElement(ue,Object.assign({key:"avatar-popover-key",destroyTooltipOnHide:!0},d),t.createElement(D,{style:G},`+${I-S}`))),b(t.createElement(W,{shape:m,size:u},t.createElement("div",{className:k,style:g},h)))}return b(t.createElement(W,{shape:m,size:u},t.createElement("div",{className:k,style:g},j)))},Ce=D;Ce.Group=he;export{Ce as A};
