const __vite__fileDeps=["./ImageLazyPreview-DN7wnJHk.js","./index-BnkMA1vW.js","./index-BM_p-30O.css","./useCacheState-C8m9yt8v.js","./MyApp-DltFDv_V.js","./index-hIwuqtzz.js","./addEventListener-Btyl3Jj6.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as m,aq as s,au as V}from"./index-BnkMA1vW.js";import{p as z,a as A,S as a,P as W,Q as q,O as Q,C as O,y as U}from"./MyApp-DltFDv_V.js";import{C as M}from"./Collection-PL0qv4MM.js";import{b as _}from"./videos-DGrkON9n.js";import{L as $}from"./index-r3NfuVoX.js";import{T as B}from"./index-DOp_86p7.js";import"./index-B93MRbNd.js";import"./file-download-DqzXDEOW.js";import"./useCacheState-C8m9yt8v.js";import"./index-dzH3ms-r.js";import"./Dropdown-CzepKDlK.js";import"./PurePanel-3wTaHio6.js";import"./index-BeeTYsU2.js";import"./TextArea-DNgpE2Ze.js";import"./addEventListener-Btyl3Jj6.js";import"./Pagination-BLedMhPS.js";import"./useBreakpoint-WmbarIyy.js";import"./responsiveObserver-BdYfetC_.js";import"./row-CNmcWAX5.js";import"./styleChecker-CFcWfr8b.js";async function F({id:n="",cursor:o=""}){var r,u,t;const c=await z({fb_api_req_friendly_name:"ProfileCometAppCollectionReelsRendererPaginationQuery",variables:{count:10,cursor:o,feedLocation:"COMET_MEDIA_VIEWER",feedbackSource:65,focusCommentID:null,renderLocation:null,scale:1,useDefaultActor:!0,id:btoa("app_collection:"+n+":168684841768375:260")},doc_id:"7821270511254925"}),p=JSON.parse(((r=c==null?void 0:c.split(`
`))==null?void 0:r[0])||"{}"),{edges:d=[],page_info:i={}}=((t=(u=p==null?void 0:p.data)==null?void 0:u.node)==null?void 0:t.aggregated_fb_shorts)||{};return d.map(e=>{var h,b,y,f,w,j,k,C,v,S,R,I,P,x,E,N,L,T;const l=((b=(h=e==null?void 0:e.profile_reel_node)==null?void 0:h.node)==null?void 0:b.short_form_video_context)||{};return{id:((w=(f=(y=e==null?void 0:e.profile_reel_node)==null?void 0:y.node)==null?void 0:f.video)==null?void 0:w.id)||atob((j=e==null?void 0:e.profile_reel_node)==null?void 0:j.id).split(":").pop(),created_time:(((C=(k=e==null?void 0:e.profile_reel_node)==null?void 0:k.node)==null?void 0:C.creation_time)||0)*1e3,description:(R=(S=(v=e==null?void 0:e.profile_reel_node)==null?void 0:v.node)==null?void 0:S.message)==null?void 0:R.text,viewCount:l==null?void 0:l.play_count_reduced,source:((I=l==null?void 0:l.playback_video)==null?void 0:I.browser_native_hd_url)||((P=l==null?void 0:l.playback_video)==null?void 0:P.browser_native_sd_url),height:(x=l==null?void 0:l.playback_video)==null?void 0:x.height,width:(E=l==null?void 0:l.playback_video)==null?void 0:E.width,thumbnail:(L=(N=l==null?void 0:l.playback_video)==null?void 0:N.image)==null?void 0:L.uri,url:l==null?void 0:l.shareable_url,length:(T=l==null?void 0:l.playback_video)==null?void 0:T.length_in_second,cursor:(e==null?void 0:e.cursor)||i.end_cursor,music:l==null?void 0:l.track_title}})}const G=m.lazy(()=>V(()=>import("./ImageLazyPreview-DN7wnJHk.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));function mi({target:n}){const{ti:o}=A(),c=m.useCallback(async(i=[],r)=>{var t;return!(n!=null&&n.id)||!(n!=null&&n.type)?void 0:(r=r||((t=i==null?void 0:i[(i==null?void 0:i.length)-1])==null?void 0:t.cursor)||"",await F({id:n.id,cursor:r}))},[n]),p=m.useCallback(async i=>({url:i.source,name:i.id+".mp4"}),[]),d=m.useCallback(i=>s.jsx($.Item,{children:s.jsxs(a,{direction:"vertical",children:[s.jsx(G,{src:i.thumbnail,width:200,height:300,style:{objectFit:"cover"},cacheId:"reels."+i.id,getPreview:()=>i.source||_(i.id).then(r=>(console.log(r),r.source)),renderPreview:(r,u)=>({destroyOnClose:!0,imageRender:()=>s.jsx(W,{spinning:u,children:s.jsx("video",{autoPlay:!0,controls:!0,loop:!0,src:r,style:{maxWidth:"90vw",maxHeight:"90vh"}})}),toolbarRender:()=>null})}),s.jsx(B.Paragraph,{style:{maxWidth:"150px",wordWrap:"break-word"},onClick:()=>window.open(i.url),children:q(i.description,100)}),s.jsxs(a,{direction:"vertical",size:1,style:{position:"absolute",top:0,left:0,padding:10,paddingBottom:50,width:"100%",background:"linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%)",pointerEvents:"none"},children:[s.jsxs(a,{children:[s.jsx("i",{className:"fa-regular fa-eye"}),i.viewCount]}),s.jsxs(a,{children:[s.jsx("i",{className:"fa-solid fa-film"}),i.length?Q(i.length):null]}),s.jsxs(a,{children:[s.jsx("i",{className:"fa-regular fa-clock"}),O(i.created_time,o({en:"en-US",vi:"vi-VN"}))]}),i.music?s.jsxs(a,{align:"start",size:4,children:[s.jsx("i",{className:"fa-solid fa-music"})," ",i.music]}):null]})]})}),[]);return s.jsx(M,{collectionName:(n==null?void 0:n.name)+" - Reels",fetchNext:c,renderItem:d,downloadItem:p,getItemCursor:i=>i.cursor,rowKey:i=>i.id,showSearch:!0,searchPlaceholder:i=>o({en:`Seach in ${i==null?void 0:i.length} Reels`,vi:`Tìm kiếm trong ${i==null?void 0:i.length} Reels`}),onSearch:(i,r)=>U(i,r.description+r.music+O(r.created_time,o({en:"en-US",vi:"vi-VN"})))})}export{mi as default};
