const __vite__fileDeps=["./UploadModal-BNq1vgCZ.js","./index-DKcwpaNn.js","./index-DfqnkV-X.css","./index-BIiDGvTk.js","./PurePanel-Dm2KaroR.js","./MyApp-CDv-rFzA.js","./useBreakpoint-SG1Oq1Ac.js","./responsiveObserver-C2jXDk8e.js","./EyeOutlined-DBKuVwCK.js","./index-CWhtpity.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{aD as Ge,ap as V,aq as J,r as _,av as i,aw as C,aA as ze,aO as Xe,aN as Z}from"./index-DKcwpaNn.js";import{d as K}from"./dayjs.min-DE2_6_Ma.js";import Ve from"./MyTable-Cfe24VBl.js";import{E as Je}from"./ExportButton-CvvFAB6e.js";import{C as O,D as q,E as Ie,h as R,i as Ae,G as Ze,H as en,c as nn,u as tn,e as ee,t as E,I as sn,J as rn,K as Ce,b as Y,T as D,o as Ee,B as De,j as Q,L as W,M as on,N as _e,O as an}from"./MyApp-CDv-rFzA.js";import{u as cn}from"./useForceStop-BTxDv_WH.js";import{d as ln}from"./messages-BISmojgc.js";import{A as dn}from"./index-D2EOnXJc.js";import{I as un}from"./index-Dg7Z2Izz.js";import{T as G}from"./index-B_vBY5DC.js";import{R as hn}from"./row-DQZWBVdA.js";import{T as gn}from"./index-CWhtpity.js";import{P as Ue}from"./index-CDyKukV1.js";import{P as z}from"./index-DWpWDo57.js";import"./index-b6__-RGH.js";import"./Table-BrmzQDbH.js";import"./addEventListener-Bihk99B1.js";import"./index-BeW64aJ1.js";import"./PurePanel-Dm2KaroR.js";import"./SearchOutlined-CyhZwKQE.js";import"./index-R4jL5rp5.js";import"./index-DHgoLQnq.js";import"./Dropdown-C-7JdpRY.js";import"./useBreakpoint-SG1Oq1Ac.js";import"./responsiveObserver-C2jXDk8e.js";import"./Pagination-cNqsTGGh.js";import"./index-DyBnpzdS.js";import"./EyeOutlined-DBKuVwCK.js";import"./file-download-DdCGTwPA.js";async function mn({myUid:a,targetUid:g=""}){const v=await O({doc_id:"4936483286421335",variables:{id:g||a,query:"",scale:1}});try{const t=q(v||"{}"),{edges:b=[]}=Ie(t,!1);return b.map(m=>{var F,y,f,w,j,U;return{uid:(F=m.node)==null?void 0:F.id,url:((y=m.node)==null?void 0:y.url)||R((f=m.node)==null?void 0:f.id),name:(w=m.node)==null?void 0:w.name,avatar:(U=(j=m.node)==null?void 0:j.photo)==null?void 0:U.uri,avatarLarge:Ae(m.node.id)}})}catch{return[]}}async function fn({myUid:a,targetUid:g}){var b;const v=await O({doc_id:"8752443744796374",variables:{input:{source:"friending_jewel",unfriended_user_id:g,actor_id:a},scale:1}}),t=q(v||"{}");if((b=t.errors)!=null&&b.length)throw new Error(t.errors[0].message);return t}async function pn({myUid:a,targetUid:g}){var b;const v=await O({doc_id:"6294978773852692",variables:{input:{attribution_id_v2:"FriendingCometRoot.react,comet.friending,tap_tabbar,1667288605315,127814,2356318349,",friend_requestee_ids:[g],people_you_may_know_location:"friends_center",refs:[null],source:"people_you_may_know",warn_ack_for_ids:[],actor_id:a},scale:2}}),t=q(v);if((b=t.errors)!=null&&b.length)throw new Error(t.errors[0].message);return t}async function kn({myUid:a,targetUid:g}){var b,m,F,y,f,w,j;const v=await O({doc_id:"5028133957233114",variables:{input:{actor_id:a,user_id:g}}}),t=q(v||"{}");if((b=t.errors)!=null&&b.length)throw new Error(t.errors[0].message);if(((y=(F=(m=t==null?void 0:t.data)==null?void 0:m.user_poke)==null?void 0:F.user)==null?void 0:y.poke_status)!="PENDING")throw new Error("Failed to poke friend: "+((j=(w=(f=t==null?void 0:t.data)==null?void 0:f.user_poke)==null?void 0:w.user)==null?void 0:j.poke_status));return t}async function xn({myUid:a,cursor:g=null}){let v=await O({doc_id:"4186250744800382",variables:{count:8,cursor:g,scale:2,id:btoa(`app_collection:${a}:2356318349:2`)}});return q(v)}async function vn(){try{const a=await Ze("https://www.facebook.com/me",{method:"GET",headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"}}),g=a.indexOf("chat_sidebar_contact_rankings");let v=g;for(;a[v]!=">"&&v>0;)v--;let t=g;for(;a[t]!="<"&&t<a.length;)t++;const b=a.substring(v+1,t),m=q(b),F=en(m,"chat_sidebar_contact_rankings");return((F==null?void 0:F.filter(y=>y.status==0))||[]).map(y=>{var f,w,j,U,$,P;return{uid:y.buddy_id||((f=y.user)==null?void 0:f.id),name:(w=y.user)==null?void 0:w.name,avatar:(U=(j=y.user)==null?void 0:j.profile_picture)==null?void 0:U.uri,hasStory:((P=($=y.story_bucket)==null?void 0:$.nodes)==null?void 0:P.length)>0}})}catch(a){return console.error(a),[]}}const yn=_.lazy(()=>ze(()=>import("./UploadModal-BNq1vgCZ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)),{Title:bn}=gn,k={FRIEND:"Friend",POKED:"Poked",UNFRIENDED:"Unfriended",REQUESTED:"Requested friend",NEW:"New friend"},jn={[k.POKED]:"green",[k.UNFRIENDED]:"red",[k.NEW]:"blue",[k.REQUESTED]:"pink"},$e=a=>{switch(a){case k.FRIEND:return{en:"Friend",vi:"Bạn bè"};case k.POKED:return{en:"Poked",vi:"Đã chọc"};case k.UNFRIENDED:return{en:"Unfriended",vi:"Đã huỷ kết bạn"};case k.REQUESTED:return{en:"Requested friend",vi:"Đã gửi kết bạn"};case k.NEW:return{en:"New friend",vi:"Bạn mới"};default:return a}},Fn=a=>{const g=(a==null?void 0:a.statuses)||[];return!g.includes(k.REQUESTED)&&(g.includes(k.NEW)||g.includes(k.UNFRIENDED))},wn=a=>{const g=(a==null?void 0:a.statuses)||[];return!g.includes(k.NEW)&&!g.includes(k.UNFRIENDED)},ne={"Name contains special characters":{en:"Special characters",vi:"Ký tự đặc biệt",color:"orange"},"Name contains numbers":{en:"Contains numbers",vi:"Chứa số",color:"purple"},"No avatar":{en:"No avatar",vi:"Không avatar",color:"cyan"},"Strange uid":{en:"Strange UID",vi:"UID lạ",color:"blue"},Locked:{en:"Locked",vi:"Bị khoá",color:"red"},"Blocked messages":{en:"Blocked messages",vi:"Chặn tin nhắn",color:"red"}},Te={MALE:{en:"Male",vi:"Nam"},FEMALE:{en:"Female",vi:"Nữ"},UNKNOW:{en:"Unknown",vi:"Không xác định"}};function et(){const{message:a,notification:g}=nn(),v=Ge(),{ti:t}=tn(),b=cn(),m=V(J.profile),F=V(J.friendsByUid),y=V(J.setFriendsByUid),[f,w]=ee("AllFriends.data",[]),[j,U]=ee("AllFriends.interactions",[]),[$,P]=ee("AllFriends.ranking",[]),B=_.useMemo(()=>{var s,o;const e=new Map,n=new Map;for(let l of j)(s=l.reactions_uid)==null||s.forEach(d=>e.set(d,(e.get(d)||0)+1)),(o=l.comments_uid)==null||o.forEach(d=>n.set(d,(n.get(d)||0)+1));return{reactions:e,comments:n}},[j]),H=_.useMemo(()=>(f==null?void 0:f.map((e,n)=>{var s,o;return{...e,recent:n,comments:((s=B==null?void 0:B.comments)==null?void 0:s.get(e.uid))||0,reactions:((o=B==null?void 0:B.reactions)==null?void 0:o.get(e.uid))||0,ranking:$==null?void 0:$.indexOf(e.uid)}}))||[],[f,B,$]),[te,ie]=_.useState(!1),[se,re]=_.useState(0),[Re,oe]=_.useState(!1),[ae,ce]=_.useState(!1),M=_.useRef(null);_.useEffect(()=>{m!=null&&m.uid&&!(f!=null&&f.length)&&le()},[]);const L=(e,n,s=!1,o=!1)=>{w(l=>Z(l,h=>{Array.isArray(e)||(e=[e]);let p=[];for(let r of e){let c=h.findIndex(x=>x.uid==((r==null?void 0:r.uid)||r)),u=h[c];u?(u.statuses||(u.statuses=[]),!s&&!u.statuses.includes(n)?u.statuses.push(n):(Array.isArray(n)||(n=[n]),u.statuses=n),o&&p.push({index:c,data:u})):o?h.unshift({...r,statuses:[n]}):h.push({...r,statuses:[n]})}for(let{index:r,data:c}of p)h.splice(r,1),h.unshift(c);return h}))},Be=(e=f)=>{let n=!1;const s=(F==null?void 0:F[m.uid])||[],o=e.map(c=>c.uid),l=s.map(c=>c.uid),d=new Set(o),h=new Set(l),p=o.filter(c=>!h.has(c)),r=l.filter(c=>!d.has(c));p.length&&(n=!0,console.log("New friends: ",p),L(p,k.NEW,!0),s!=null&&s.length?g.open({type:"success",duration:0,message:t({en:`Find ${p.length} new friends`,vi:`Tìm thấy ${p.length} bạn mới`}),description:i.jsx("div",{style:{maxHeight:300,overflowY:"auto",overflowX:"hidden"},children:i.jsx("ol",{children:p.map(c=>{const u=e.find(x=>x.uid==c);return i.jsx("li",{children:i.jsx("a",{href:R(c),target:"_blank",children:(u==null?void 0:u.name)||c})},c)})})})}):g.open({type:"success",duration:0,message:t({en:`Saved friends to cache: ${p.length}`,vi:`Đã lưu danh sách bạn bè: ${p.length}`}),description:t({en:"Will notify if you have new friends / someone unfriended to you in future",vi:"Sẽ thông báo nếu có bạn mới / người huỷ kết bạn với bạn trong tương lai"})})),r.length&&(n=!0,console.log("Deleted friends: ",r),g.open({type:"info",duration:0,message:t({en:`Find ${r.length} unfriended`,vi:`Có ${r.length} người huỷ kết bạn`}),description:i.jsx("div",{style:{maxHeight:300,overflowY:"auto",overflowX:"hidden"},children:i.jsx("ol",{children:r.map(c=>{const u=s.find(x=>x.uid==c);return i.jsx("li",{children:i.jsx("a",{href:R(c),target:"_blank",children:(u==null?void 0:u.name)||c})},c)})})})})),n&&y(m==null?void 0:m.uid,e.map(c=>({uid:c.uid,name:c.name})))},le=()=>{if(te)return;E("AllFriends:onClickReload");const e="onClickReload";a.loading({key:e,content:t({en:"Fetching friends...",vi:"Đang tải bạn bè..."}),duration:0}),ie(!0),mn({myUid:m==null?void 0:m.uid}).then(n=>{var o;if(Be(n),!(n!=null&&n.length))return a.error({key:e,content:t({en:"No data to show",vi:"Không có dữ liệu"})});const s=n.map(l=>{var d;return{...l,quickFilters:[(d=l.uid)!=null&&d.startsWith("1000")?null:"Strange uid",sn(l.avatar)?"No avatar":null,/\d/.test(l.name)?"Name contains numbers":null,rn(l.name)?"Name contains special characters":null].filter(Boolean)}});w(s),console.log(s),a.success({key:e,content:t({en:"Fetch friends completed",vi:"Tải xong bạn bè"})}),(o=M.current)==null||o.clearFilter()}).catch(n=>{a.error({key:e,content:t({en:"Failed to fetch friends",vi:"Lỗi tải bạn bè"})+": "+n.message}),console.log(n)}).finally(()=>{ie(!1)})},de=async e=>{E("AllFriends:onClickUnfriendOne");const n="onClickUnfriendOne"+e.uid;try{return a.loading({key:n,content:t({en:"Unfriending...",vi:"Đang huỷ kết bạn..."})+" "+e.name,duration:0}),await fn({myUid:m==null?void 0:m.uid,targetUid:e.uid}),a.success({key:n,content:t({en:"Unfriend completed",vi:"Đã huỷ kết bạn"})+": "+e.name}),L(e,k.UNFRIENDED),!0}catch(s){return a.error({key:n,content:t({en:"Failed to unfriend",vi:"Lỗi huỷ kết bạn"})+": "+e.name+": "+s.message}),console.log(s),!1}},qe=async e=>{if(!await Q())return;E("AllFriends:onClickUnfriendSelected");const n=new Set;for(let o of e)await de(o)&&n.add(o.uid),await W(500);const s=n.size+"/"+e.length;g.open({type:"success",message:t({en:"Success",vi:"Thành công"}),description:t({en:`Unfriended completed ${s} friends`,vi:`Đã huỷ kết bạn với ${s} người`}),duration:0})},ue=async e=>{E("AllFriends:onClickPokeFriend");const n="onClickPokeFriend"+e.uid;try{return a.loading({key:n,content:t({en:"Poking...",vi:"Đang chọc..."})+" "+e.name,duration:0}),await kn({myUid:m==null?void 0:m.uid,targetUid:e.uid}),a.success({key:n,content:t({en:"Poke completed",vi:"Chọc thành công"})+": "+e.name}),L(e,k.POKED),!0}catch(s){return a.error({key:n,content:t({en:"Failed to poke",vi:"Chọc thất bại"})+": "+e.name+": "+s.message}),console.log(s),!1}},Le=async e=>{E("AllFriends:onClickPokeSelected");const n=new Set;for(let o of e)await ue(o)&&n.add(o.uid),await W(500);const s=n.size+"/"+e.length;g.open({type:"success",message:t({en:"Success",vi:"Thành công"}),description:t({en:`Poke completed ${s} friends`,vi:`Đã chọc ${s} bạn`}),duration:0})},he=async e=>{E("AllFriends:onClickAddFriend");const n="onClickAddFriend"+e.uid;try{return a.loading({key:n,content:t({en:"Sending friend request...",vi:"Đang gửi kết bạn..."})+" "+e.name,duration:0}),await pn({myUid:m==null?void 0:m.uid,targetUid:e.uid}),a.success({key:n,content:t({en:"Send friend request success",vi:"Gửi kết bạn thành công"})+": "+e.name}),L(e,k.REQUESTED),!0}catch(s){return a.error({key:n,content:t({en:"Failed to send friend request",vi:"Lỗi gửi kết bạn"})+": "+s.message}),!1}},Se=async e=>{if(!await Q())return;E("AllFriends:onClickAddFriendSelected");const n=new Set;for(let o of e)await he(o)&&n.add(o.uid),await W(500);const s=n.size+"/"+e.length;g.open({type:"success",message:t({en:"Success",vi:"Thành công"}),description:t({en:`Sent friend request success ${s} users`,vi:`Gửi kết bạn thành công với ${s} người`}),duration:0})},Me=async()=>{var h,p;if(se)return;const e="AllFriends:onClickFindBlockedMessages";E(e);const n=(h=M.current)==null?void 0:h.getDataSelected(),s=n!=null&&n.length?n:f,o=[];let l=!1;for(let r=0;r<s.length&&!l;r++){re(!0),a.loading({key:e,duration:0,content:i.jsxs(i.Fragment,{children:[t({en:"Finding blocked messages...",vi:"Đang tìm bạn bè chặn tin nhắn..."})+`${o.length}/${r+1} - ${~~(r/s.length*100)}%`,i.jsx("br",{}),i.jsx("i",{children:t({en:"Click to stop",vi:"Bấm để dừng"})})]}),onClick:()=>l=!0});const c=s[r];await ln(c.uid)||(o.push(c),(p=M.current)==null||p.setDataSelected(o.map(u=>f.find(x=>x.uid===u.uid)||u)),w(u=>Z(u,x=>{var T;const N=x.find(I=>I.uid===c.uid);N&&!((T=N.quickFilters)!=null&&T.includes("Blocked messages"))&&(N.quickFilters||(N.quickFilters=[]),N.quickFilters.push("Blocked messages"))})),a.success({key:e,content:t({en:"Found",vi:"Tìm thấy"})+" "+c.name+" ("+o.length+")"}))}re(!1);const d=o.length?i.jsxs(i.Fragment,{children:[t({en:`Found ${o.length} friends blocking your messages`,vi:`Tìm thấy ${o.length} bạn bè chặn tin nhắn`}),i.jsx("br",{}),i.jsx("ul",{children:o.map(r=>i.jsx("li",{children:r.name},r.uid))})]}):t({en:"No one block messages you",vi:"Không ai chặn tin nhắn của bạn"});a.success({key:e,content:d}),g.open({type:"success",message:t({en:"Success",vi:"Thành công"}),description:d,duration:0})},Ye=async e=>{var n;if(!e)return a.error(t({en:"File empty",vi:"File rỗng"}));E("AllFriends:onUploadFriendsFile");try{const s=q(e,[]);if(!Array.isArray(s)||!(s!=null&&s.length))return a.error(t({en:"No data",vi:"Không có dữ liệu"}));const o=s.map(r=>r.uid).filter(Boolean);debugger;if(!o.length)return a.error(t({en:"No friends data in file",vi:"Không có dữ liệu bạn bè trong file"}));const l=new Set(o),d=[];for(let r of f)l.has(r.uid)||d.push(r);const h=new Set(f.map(r=>r.uid)),p=[];for(let r of s)h.has(r.uid)||p.push(r);L(d,k.NEW,!1,!0),L(p,k.UNFRIENDED,!1,!0),[{title:t({en:`Found ${d.length} new friends`,vi:`Tìm thấy ${d.length} bạn mới`}),text:i.jsx("div",{style:{maxHeight:300,overflowY:"auto",overflowX:"hidden"},children:i.jsx("ol",{children:d.map(r=>i.jsx("li",{children:i.jsx("a",{href:R(r.uid),target:"_blank",children:r.name})},r.uid))})})},{title:t({en:`Found ${p.length} unfriended`,vi:`Tìm thấy ${p.length} người huỷ kết bạn`}),text:i.jsx("div",{style:{maxHeight:300,overflowY:"auto",overflowX:"hidden"},children:i.jsx("ol",{children:p.map(r=>i.jsx("li",{children:i.jsx("a",{href:R(r.uid),target:"_blank",children:r.name})},r.uid))})})}].forEach(({title:r,text:c})=>g.open({type:"success",message:r,description:c,duration:0})),(p.length||d.length)&&((n=M.current)==null||n.setDataSelected([...p,...d]))}catch(s){a.error(s.message)}},Oe=e=>{v("/bulk-downloader",{state:{targetId:e,platform:Xe.Facebook}})},Pe=async()=>{if(!await Q()||ae)return;ce(!0);const e=b.start(),n="AllFriends:onClickScanInteractions";E(n),a.loading({key:n,duration:0,content:t({en:"Loading posts...",vi:"Đang tải bài viết..."})});let s=!1;const o=await on(1/0,r=>{var T;U([...r]);const c=r.reduce((I,S)=>{var A;return I+(((A=S.comments_uid)==null?void 0:A.length)||0)},0),u=r.reduce((I,S)=>{var A;return I+(((A=S.reactions_uid)==null?void 0:A.length)||0)},0),x=new Date(((T=r[r.length-1])==null?void 0:T.created_time)||0),N=_e(x);a.loading({key:n,duration:0,content:i.jsxs(i.Fragment,{children:[t({en:`Loading ${N}: ${r.length} posts, ${u} reactions, ${c} comments...`,vi:`Đang tải ${N}: ${r.length} bài viết, ${u} lượt thích, ${c} bình luận...`}),i.jsx("br",{}),i.jsx("i",{children:t({en:"Click to stop",vi:"Bấm để dừng"})})]}),onClick:()=>s=!0})},()=>s||e.value()),l=o.reduce((r,c)=>{var u;return r+(((u=c.comments_uid)==null?void 0:u.length)||0)},0),d=o.reduce((r,c)=>{var u;return r+(((u=c.reactions_uid)==null?void 0:u.length)||0)},0);a.destroy(n);const h=o[o.length-1],p=_e(new Date((h==null?void 0:h.created_time)||0));g.open({type:"success",duration:0,message:t({en:"Scan interactions finished",vi:"Quét tương tác xong"}),description:i.jsxs(i.Fragment,{children:[t({en:`Scanned ${o.length} posts, ${d} reactions, ${l} comments, last post ${p} `,vi:`Quét được ${o.length} bài viết, ${d} lượt thích, ${l} bình luận, bài viết cuối ${p} `}),i.jsx("a",{href:R(h==null?void 0:h.postId),target:"_blank",children:R(h==null?void 0:h.postId)})]})}),U(o),ce(!1)},He=async()=>{const e="AllFriends:onClickFindBuddy";E(e),a.loading({key:e,duration:0,content:t({en:"Scanning ranking friends...",vi:"Đang tải xếp hạng bạn bè..."})});const n=await vn();console.log(n),a.destroy(e),g.open({type:"success",duration:0,message:t({en:`Scan ranking completed: ${n.length} friends`,vi:`Quét xếp hạng bạn bè xong: ${n.length} bạn`}),description:i.jsxs(i.Fragment,{children:["Top 20:",i.jsx("br",{}),i.jsx("ol",{children:n.slice(0,20).map((s,o)=>i.jsxs(i.Fragment,{children:[i.jsx("a",{href:R(s.uid),target:"_blank",children:o+1+": "+s.name},s.uid),i.jsx("br",{})]}))})]})}),P(n.map(s=>s.uid))},Ke=async()=>{if(!await Q())return;oe(!0);const e="AllFriends:onClickDeepScan";E(e),a.loading({key:e,content:t({en:"Deep Scanning...",vi:"Đang quét chuyên sâu..."}),duration:0});const n=await an(),s=[];let o=null;for(;;){const l=await xn({myUid:n,cursor:o}),{edges:d=[],page_info:h={}}=Ie(l)||{};if(!d.length)break;const p=d.map(r=>{var u,x,N,T,I,S,A,ge,me,fe,pe,ke,xe,ve,ye,be,je,Fe,we,Ne;let c=(x=(u=r==null?void 0:r.node)==null?void 0:u.node)==null?void 0:x.id;if(!/^\d+$/.exec(c))try{let X=atob(c);c=((N=/\d+/.exec(X))==null?void 0:N[0])||c}catch(X){console.log(X)}return{uid:c,name:(I=(T=r==null?void 0:r.node)==null?void 0:T.title)==null?void 0:I.text,avatar:(A=(S=r==null?void 0:r.node)==null?void 0:S.image)==null?void 0:A.uri,avatarLarge:Ae(c),url:(ge=r==null?void 0:r.node)==null?void 0:ge.url,mutualFriendCount:((ke=(pe=(fe=(me=r==null?void 0:r.node)==null?void 0:me.subtitle_text)==null?void 0:fe.aggregated_ranges)==null?void 0:pe[0])==null?void 0:ke.count)||0,gender:((Fe=(je=(be=(ye=(ve=(xe=r==null?void 0:r.node)==null?void 0:xe.actions_renderer)==null?void 0:ve.action)==null?void 0:ye.client_handler)==null?void 0:be.profile_action)==null?void 0:je.restrictable_profile_owner)==null?void 0:Fe.gender)||"UNKNOW",isLocked:!((we=r==null?void 0:r.node)!=null&&we.subtitle_text)||!((Ne=r==null?void 0:r.node)!=null&&Ne.url),cursor:(r==null?void 0:r.cursor)||(h==null?void 0:h.end_cursor)}});w(r=>Z(r,c=>(p.forEach(u=>{if(!u.uid)return;const x=c.find(N=>N.uid===u.uid);x?(x.mutualFriendCount=u.mutualFriendCount,x.gender=u.gender,x.quickFilters||(x.quickFilters=[]),u.isLocked&&!x.quickFilters.includes("Locked")&&x.quickFilters.push("Locked")):u.isLocked&&c.push({...u,quickFilters:["Locked"]})}),c))),s.push(...p),o=p[p.length-1].cursor,a.loading({key:e,content:t({en:"Deep Scanning...",vi:"Đang quét chuyên sâu..."})+`${~~(s.length/f.length*100)}% (${s.length}/${f.length})`,duration:0}),await W(200)}a.destroy(e),g.open({type:"success",message:t({en:"Deep Scanning completed",vi:"Hoàn tất Quét chuyên sâu"})+` (${s.length}/${f.length})`,description:t({en:'Please see in "Quick filters" column',vi:'Vui lòng xem cột "Bộ lọc"'})}),oe(!1)},Qe=[{title:"#",key:"recent",dataIndex:"recent",sorter:(e,n)=>e.recent-n.recent,render:(e,n,s)=>n.recent+1,width:70,align:"center"},{title:t({en:"Name",vi:"Tên"}),dataIndex:"name",key:"name",sorter:(e,n)=>e.name.localeCompare(n.name),onSearch:(e,n,s)=>Ce(e,n)||Ce(e,s==null?void 0:s.uid),render:(e,n,s)=>i.jsxs(Y,{style:{maxWidth:300},children:[i.jsx(dn,{shape:"square",src:i.jsx(un,{src:n.avatarLarge,fallback:n.avatar}),size:50}),i.jsxs(Y,{direction:"vertical",style:{marginLeft:"10px"},size:0,children:[i.jsx("a",{href:n.url,target:"_blank",children:i.jsx("b",{children:n.name})}),i.jsx("span",{style:{opacity:.5},children:n.uid})]})]}),width:"auto"},{title:t({en:"Quick Filters",vi:"Bộ lọc"}),dataIndex:"quickFilters",key:"quickFilters",render:(e,n,s)=>{var o;return((o=n.quickFilters)==null?void 0:o.map(l=>i.jsx(G,{color:ne[l].color,children:t(ne[l])},l)))||""},filters:Object.entries(ne).map(([e,n])=>({text:t(n)+" ("+f.filter(s=>{var o;return(o=s.quickFilters)==null?void 0:o.includes(e)}).length+")",value:e})),onFilter:(e,n)=>{var s;return(s=n.quickFilters)==null?void 0:s.includes(e)},width:150},...f.find(e=>e.gender)?[{title:t({en:"Gender",vi:"Giới tính"}),key:"gender",dataIndex:"gender",render:(e,n,s)=>{const o=t(Te[n.gender])||"-";return n.gender==="FEMALE"?i.jsx(G,{color:"pink",children:o}):o},filters:Object.entries(Te).map(([e,n])=>({text:t(n)+" ("+f.filter(s=>s.gender===e).length+")",value:e})),onFilter:(e,n)=>n.gender==e,width:120}]:[],...f.find(e=>e.mutualFriendCount)?[{title:t({en:"Mutual",vi:"Bạn chung"}),key:"mutualFriendCount",dataIndex:"mutualFriendCount",sorter:(e,n)=>e.mutualFriendCount-n.mutualFriendCount,width:120,align:"right"}]:[],...$.length?[{title:t({en:"Ranking",vi:"Xếp hạng"}),key:"ranking",dataIndex:"ranking",render:(e,n,s)=>e==-1?"_":e+1,sorter:(e,n)=>(e.ranking==-1?1/0:e.ranking)-(n.ranking==-1?1/0:n.ranking),width:100,align:"right"}]:[],...j!=null&&j.length?[{title:t({en:"Reactions",vi:"Thích"}),key:"reactions",dataIndex:"reactions",sorter:(e,n)=>e.reactions-n.reactions,width:100,align:"right"},{title:t({en:"Comments",vi:"Bình luận"}),key:"comments",dataIndex:"comments",sorter:(e,n)=>e.comments-n.comments,width:100,align:"right"}]:[],{title:t({en:"Friend status",vi:"Trạng thái"}),dataIndex:"status",key:"status",width:150,filters:Object.entries(k).map(([e,n])=>({text:t($e(n))+" ("+f.filter(s=>{var o,l;return((o=s.statuses)==null?void 0:o.includes(n))||n===k.FRIEND&&!((l=s.statuses)!=null&&l.length)}).length+")",value:n})),onFilter:(e,n)=>{var s,o;return((s=n.statuses)==null?void 0:s.includes(e))||e==k.FRIEND&&!((o=n.statuses)!=null&&o.length)},render:(e,n,s)=>{var o;return(o=n==null?void 0:n.statuses)!=null&&o.length?n.statuses.map(l=>({key:l,value:t($e(l))})).map(({key:l,value:d})=>i.jsx(G,{color:jn[l],children:d},l)):t({en:"Friend",vi:"Bạn bè"})},align:"right"},{title:t({en:"Action",vi:"Hành động"}),dataIndex:"action",key:"download",render:(e,n,s)=>{var o,l;return i.jsxs(Y.Compact,{children:[i.jsx(D,{title:t({en:"Bulk Downloader",vi:"Tải hàng loạt"}),children:i.jsx(C,{type:"default",onClick:()=>Oe(n.uid),icon:i.jsx("i",{className:"fa-solid fa-download"})})}),i.jsx(D,{title:t({en:"Poke",vi:"Chọc"}),children:i.jsx(C,{type:"default",onClick:()=>ue(n),icon:i.jsx("i",{className:"fa-regular fa-hand-point-right"})})}),(o=n.statuses)!=null&&o.includes(k.UNFRIENDED)||(l=n.statuses)!=null&&l.includes(k.NEW)?i.jsx(D,{title:t({en:"Request friend",vi:"Gửi kết bạn"}),children:i.jsx(C,{type:"default",onClick:()=>he(n),icon:i.jsx("i",{className:"fa-solid fa-user-plus"})})}):i.jsx(D,{title:t({en:"Unfriend",vi:"Huỷ kết bạn"}),children:i.jsx(C,{danger:!0,onClick:()=>de(n),icon:i.jsx("i",{className:"fa-solid fa-trash-can"})})})]})},width:150,align:"right"}],We=e=>{var o,l;const n=(o=e==null?void 0:e.filter)==null?void 0:o.call(e,Fn),s=(l=e==null?void 0:e.filter)==null?void 0:l.call(e,wn);return i.jsxs(i.Fragment,{children:[i.jsx(C,{type:"primary",icon:te?i.jsx("i",{className:"fa-solid fa-rotate-right fa-spin"}):i.jsx("i",{className:"fa-solid fa-rotate-right"}),onClick:le,children:t({en:"Reload",vi:"Tải lại"})}),i.jsx(Je,{data:e.length?e:f,options:[{key:"uid",label:".txt (friend uid)",prepareData:d=>({fileName:"friends_"+K().format("YYYY-MM-DD-HHmmss")+".txt",data:d.map(h=>h.uid).join(`
`)})},{key:"uid_name",label:".csv (friend uid+name)",prepareData:d=>({fileName:"friends_uid_name_"+K().format("YYYY-MM-DD-HHmmss")+".csv",data:Ee(d.map(h=>({uid:h.uid,name:h.name})))})},{key:"json",label:".json",prepareData:d=>({fileName:"friends"+K().format("YYYY-MM-DD-HHmmss")+".json",data:JSON.stringify(d,null,4)})},{key:"csv",label:".csv",prepareData:d=>({fileName:"friends"+K().format("YYYY-MM-DD-HHmmss")+".csv",data:Ee(d)})}]}),i.jsxs(Y.Compact,{children:[i.jsx(Ue,{title:t({en:"Check who is blocking your messages",vi:"Xem ai đang chặn tin nhắn của bạn"}),content:i.jsxs("ul",{children:[i.jsx("li",{children:t({en:"You still can message them",vi:"Bạn vẫn nhắn được cho họ"})}),i.jsx("li",{children:t({en:"They can still read your messages",vi:"Họ vẫn đọc được tin nhắn"})}),i.jsx("li",{children:t({en:"But facebook will never mark as read",vi:"Nhưng facebook sẽ không cập nhật trạng thái đã xem"})})]}),children:i.jsx(z,{title:t(t({en:"Check who is blocking your messages",vi:"Xem ai đang chặn tin nhắn của bạn"})),description:i.jsxs("ul",{children:[i.jsx("li",{children:t({en:`Are you sure to check ${(e==null?void 0:e.length)||H.length} friends?.
 `,vi:`Bạn có chắc muốn kiểm tra ${(e==null?void 0:e.length)||H.length} bạn bè?.`})}),i.jsx("li",{children:t({en:"You can select friends to check, instead of check all, to reduce load time.",vi:"Bạn có thể chọn bạn bè để kiểm tra, thay vì kiểm tra tất cả, để giảm thời gian xử lý."})})]}),onConfirm:Me,okText:t({en:"Yes",vi:"Kiểm tra"}),cancelText:t({en:"No",vi:"Huỷ"}),children:i.jsx(C,{loading:!!se,icon:i.jsx("i",{className:"fa-solid fa-comment-slash"})})})}),i.jsx(yn,{accept:".json",title:t({en:"Upload friends file",vi:"Tải lên file bạn bè đã lưu"}),text:t({en:"Click or drag file to this area to upload",vi:"Click chọn hoặc kéo thả file vào đây"}),hint:t({en:"Support only .json backup file",vi:"Chỉ hỗ trợ file .json được xuất từ trang này"}),onSubmit:Ye,renderButton:({showModal:d})=>i.jsx(Ue,{title:t({en:"Check who unfriend you",vi:"Kiểm tra ai huỷ kết bạn với bạn"}),content:i.jsxs("ul",{children:[i.jsx("li",{children:t({en:"How it work: Export friends data to file, then compare it later",vi:"Cách hoạt động: Lưu danh sách bạn bè ra file trước, sau đó so sánh"})}),i.jsx("li",{children:t({en:"FB AIO can automatically detect who unfriend you",vi:"FB AIO sẽ tự động thông báo khi có người huỷ kết bạn"})}),i.jsx("li",{children:t({en:"Only use this feature if you want manual check",vi:"Chỉ sử dụng chức năng này nếu bạn muốn chủ động kiểm tra bằng tay"})})]}),children:i.jsx(C,{onClick:d,icon:i.jsx("i",{className:"fa-solid fa-user-slash"})})})}),i.jsx(D,{title:t({en:"Rank who has interacted with you the most recently. (Recent interactions)",vi:"Xếp hạng xem ai tương tác với bạn nhiều nhất thời gian gần đây (Tương tác gần đây)"}),children:i.jsx(C,{onClick:He,icon:i.jsx("i",{className:"fa-solid fa-ranking-star"}),children:t({en:"Ranking",vi:"Xếp hạng"})})}),i.jsx(D,{title:t({en:"Count friend's reactions and comments on all of your profile's posts (Total interactions)",vi:"Đếm like và comment của bạn bè trên tất cả bài viết của bạn (Tổng tương tác)"}),children:i.jsx(De,{count:"Hot",color:"red",style:{color:"white",zIndex:3},children:i.jsx(C,{loading:ae,icon:i.jsx("i",{className:"fa-solid fa-thumbs-up"}),onClick:Pe,children:t({en:"Interactions",vi:"Tương tác"})})})}),i.jsx(D,{title:t({en:"Deep scan all friends to get: locked friends, gender, mutual friends ...",vi:"Quét tất cả bạn bè để biết: bạn bè bị khoá, giới tính, bạn chung ..."}),children:i.jsx(De,{count:t({en:"New",vi:"Mới"}),color:"purple",style:{color:"white",zIndex:3},children:i.jsx(C,{loading:!!Re,onClick:Ke,icon:i.jsx("i",{className:"fa-solid fa-magnifying-glass"}),children:t({en:"Deep scan",vi:"Quét chuyên sâu"})})})})]}),i.jsx(Y.Compact,{children:e!=null&&e.length?i.jsxs(i.Fragment,{children:[i.jsx(D,{title:t({en:`Poke ${e.length} selected friends`,vi:`Chọc ${e.length} người được chọn`}),children:i.jsx(z,{title:t({en:`Poke ${e.length} selected friends`,vi:`Chọc ${e.length} người được chọn`}),description:t({en:"Are you sure to poke these friends?",vi:"Bạn có chắc muốn chọc những người này?"}),onConfirm:()=>Le(e),okText:t({en:"Yes",vi:"Chọc mạnh vào"}),cancelText:t({en:"No",vi:"Tha"}),children:i.jsx(C,{type:"default",icon:i.jsx("i",{className:"fa-solid fa-hand-point-right"}),children:e.length?" "+e.length:""})})}),(n==null?void 0:n.length)>0?i.jsx(D,{title:t({en:`Request friend with ${n.length} selected users`,vi:`Gửi kết bạn với ${n.length} người được chọn`}),children:i.jsx(z,{title:t({en:`Request friend with ${n.length} selected users`,vi:`Gửi kết bạn với ${n.length} người được chọn`}),description:t({en:"Are you sure to send friend request to these users?",vi:"Bạn có chắc muốn gửi lời mời kết bạn cho những người này?"}),onConfirm:()=>Se(n),okText:t({en:"Yes",vi:"Gửi"}),cancelText:t({en:"No",vi:"Huỷ"}),children:i.jsx(C,{icon:i.jsx("i",{className:"fa-solid fa-user-plus"}),children:n.length})})}):null,(s==null?void 0:s.length)>0?i.jsx(D,{title:t({en:`Unfriend ${s.length} selected friends`,vi:`Huỷ kết bạn ${s.length} người được chọn`}),children:i.jsx(z,{title:t({en:`Unfriend ${s.length} selected friends`,vi:`Huỷ kết bạn ${s.length} người được chọn`}),description:t({en:"Are you sure to unfriend these friends?",vi:"Bạn có chắc muốn huỷ kết bạn những người này?"}),onConfirm:()=>qe(s),okText:t({en:"Yes",vi:"Bye bye"}),cancelText:t({en:"No",vi:"Tha"}),children:i.jsx(C,{danger:!0,icon:i.jsx("i",{className:"fa-solid fa-trash-can"}),children:s.length})})}):null]}):null})]})};return i.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[i.jsxs(hn,{align:"middle",style:{margin:"16px"},children:[i.jsx(bn,{level:3,style:{margin:0},children:t({en:"Friends manager",vi:"Quản lý bạn bè"})}),i.jsx(G,{style:{marginLeft:"10px",fontWeight:"bold",color:"#888"},children:H.length})]}),i.jsx(Ve,{ref:M,data:H,columns:Qe,size:"small",searchable:!0,selectable:!0,keyExtractor:e=>e.uid,style:{flex:1,maxHeight:"100%"},renderTitle:We})]})}export{et as default};
