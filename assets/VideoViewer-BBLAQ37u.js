import{r,av as i,aw as j}from"./index-DKcwpaNn.js";import{A as F,V as p}from"./VideoWithMuted-CHYHsZkU.js";import{u as q,aA as S,b as z,T as A,aB as V,t as L}from"./MyApp-CDv-rFzA.js";function B({info:t,style:w,videoStyle:C,buttonTop:c=!1}){var m,f,g,x,y;const{ti:R}=q(),[s,o]=r.useState(null),[l,E]=r.useState({}),[n,b]=r.useState(0),d=(s==null?void 0:s.source)||t.source;(g=(f=(m=t.variants)==null?void 0:m.filter(e=>!e.isAudio))==null?void 0:f.sort((e,a)=>a.width*a.height-e.width*e.height))==null||g[0],(x=t.variants)==null||x.find(e=>e.isAudio);const u=r.useRef(!1);r.useEffect(()=>{var e;(e=t.variants)!=null&&e.length&&!Object.keys(l).length&&!u.current&&(u.current=!0,Promise.all(t.variants.map(a=>S(a.source).then(k=>{E(v=>({...v,[a.id]:k}))}).catch(()=>{console.log("ERROR get size",a)}))).finally(()=>{u.current=!1}))},[l,t.variants]),r.useEffect(()=>{t.source&&S(t.source).then(e=>{b(e)})},[t.source]);const h=i.jsxs(z.Compact,{children:[i.jsx(A,{title:n?V(n,1):"",children:i.jsx(j,{type:s?"default":"primary",onClick:()=>o(null),children:R({en:"Default",vi:"Mặc định"})})}),(y=t.variants)==null?void 0:y.map((e,a)=>i.jsx(A,{title:(e.isAudio?"":e.width+"x"+e.height)+(l[e.id]?" - "+V(l[e.id],1):""),children:i.jsxs(j,{type:(s==null?void 0:s.id)===e.id?"primary":"default",onClick:()=>{L("VideoViewer:onChangeVariant:"+(e.qualityLabel||e.mimeType)),o(e)},icon:e.isAudio?i.jsx("i",{className:"fa-solid fa-music"}):null,children:[e.qualityClass," ",e.qualityLabel||e.mimeType]})},e.id))]});return i.jsxs(z,{direction:"vertical",style:{padding:15,borderRadius:10,backgroundColor:"#222",justifyContent:"center",alignItems:"center",...w},children:[c&&h,s!=null&&s.isAudio?i.jsx(F,{src:d}):i.jsx(p,{src:d,style:{maxWidth:"80vw",maxHeight:"80vh",...C}}),!c&&h]})}export{B as default};
