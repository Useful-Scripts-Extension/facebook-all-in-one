const __vite__fileDeps=["./ImageLazyPreview-DNyZsNRZ.js","./index-CWHWDdhg.js","./index-DjlRUb8J.css","./MyApp-DiD1gO8G.js","./index-Du8Zg1nD.js","./addEventListener-Dp_BcOaT.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as t,ao as e,as as V}from"./index-CWHWDdhg.js";import{x as A,a as O,S as o,Y as W,Z as U,X as q,f as z,z as M}from"./MyApp-DiD1gO8G.js";import{C as Q}from"./Collection-B57Hh8_V.js";import{b as _}from"./index-Bc1RnSdr.js";import{L as $}from"./index-BoAKsnJq.js";import{T as B}from"./index-DjBDOqYF.js";import"./index-B1Q6nZGX.js";import"./file-download-CQfrbO-d.js";import"./index-CYj5WurI.js";import"./Dropdown-8qusH5Hu.js";import"./PurePanel-CMHkUot4.js";import"./index-BKlkw6_z.js";import"./index-CuG7pCf6.js";import"./index-BMAX8IRk.js";import"./addEventListener-Dp_BcOaT.js";import"./index-CKhQW3B4.js";import"./index-C3tirfBv.js";import"./feeds-DdS_e31m.js";import"./index-vuHwb1ab.js";import"./index-DOdHAQsL.js";import"./responsiveObserver-pBLgsxqE.js";import"./useBreakpoint-C9pck-6k.js";import"./index-BmML-HVI.js";import"./index-CxWXwsg9.js";import"./index-DlqUfLt0.js";import"./index-Du8Zg1nD.js";import"./index-pmWz-1Bh.js";import"./Pagination-CXPcNn_5.js";import"./row-DavXLXaE.js";async function F({id:n="",cursor:a=""}){var s,u,m;const p=await A({fb_api_req_friendly_name:"ProfileCometAppCollectionReelsRendererPaginationQuery",variables:{count:10,cursor:a,feedLocation:"COMET_MEDIA_VIEWER",feedbackSource:65,focusCommentID:null,renderLocation:null,scale:1,useDefaultActor:!0,id:btoa("app_collection:"+n+":168684841768375:260")},doc_id:"7821270511254925"}),c=JSON.parse(((s=p==null?void 0:p.split(`
`))==null?void 0:s[0])||"{}"),{edges:d=[],page_info:i={}}=((m=(u=c==null?void 0:c.data)==null?void 0:u.node)==null?void 0:m.aggregated_fb_shorts)||{};return d.map(r=>{var h,b,f,y,w,j,k,C,v,R,S,x,I,E,P,N,L,T;const l=((b=(h=r==null?void 0:r.profile_reel_node)==null?void 0:h.node)==null?void 0:b.short_form_video_context)||{};return{id:((w=(y=(f=r==null?void 0:r.profile_reel_node)==null?void 0:f.node)==null?void 0:y.video)==null?void 0:w.id)||atob((j=r==null?void 0:r.profile_reel_node)==null?void 0:j.id).split(":").pop(),created_time:(((C=(k=r==null?void 0:r.profile_reel_node)==null?void 0:k.node)==null?void 0:C.creation_time)||0)*1e3,description:(S=(R=(v=r==null?void 0:r.profile_reel_node)==null?void 0:v.node)==null?void 0:R.message)==null?void 0:S.text,viewCount:l==null?void 0:l.play_count_reduced,source:((x=l==null?void 0:l.playback_video)==null?void 0:x.browser_native_hd_url)||((I=l==null?void 0:l.playback_video)==null?void 0:I.browser_native_sd_url),height:(E=l==null?void 0:l.playback_video)==null?void 0:E.height,width:(P=l==null?void 0:l.playback_video)==null?void 0:P.width,thumbnail:(L=(N=l==null?void 0:l.playback_video)==null?void 0:N.image)==null?void 0:L.uri,url:l==null?void 0:l.shareable_url,length:(T=l==null?void 0:l.playback_video)==null?void 0:T.length_in_second,cursor:(r==null?void 0:r.cursor)||i.end_cursor,music:l==null?void 0:l.track_title}})}const G=t.lazy(()=>V(()=>import("./ImageLazyPreview-DNyZsNRZ.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url));function Ci({target:n}){const{ti:a}=O(),p=t.useCallback(async(i=[],s)=>{var m;return!(n!=null&&n.id)||!(n!=null&&n.type)?void 0:(s=s||((m=i==null?void 0:i[(i==null?void 0:i.length)-1])==null?void 0:m.cursor)||"",await F({id:n.id,cursor:s}))},[n]),c=t.useCallback(async i=>({url:i.source,name:i.id+".mp4"}),[]),d=t.useCallback(i=>e.jsx($.Item,{children:e.jsxs(o,{direction:"vertical",children:[e.jsx(G,{src:i.thumbnail,width:200,height:300,style:{objectFit:"cover"},cacheId:"reels."+i.id,getPreview:()=>i.source||_(i.id).then(s=>(console.log(s),s.source)),renderPreview:(s,u)=>({destroyOnClose:!0,imageRender:()=>e.jsx(W,{spinning:u,children:e.jsx("video",{autoPlay:!0,controls:!0,loop:!0,src:s,style:{maxWidth:"90vw",maxHeight:"90vh"}})}),toolbarRender:()=>null})}),e.jsx(B.Paragraph,{style:{maxWidth:"150px",wordWrap:"break-word"},onClick:()=>window.open(i.url),children:U(i.description,100)}),e.jsxs(o,{direction:"vertical",size:1,style:{position:"absolute",top:0,left:0,padding:10,paddingBottom:50,width:"100%",background:"linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%)",pointerEvents:"none"},children:[e.jsxs(o,{children:[e.jsx("i",{className:"fa-regular fa-eye"}),i.viewCount]}),e.jsxs(o,{children:[e.jsx("i",{className:"fa-solid fa-film"}),i.length?q(i.length):null]}),e.jsxs(o,{children:[e.jsx("i",{className:"fa-regular fa-clock"}),z(i.created_time,a({en:"en-US",vi:"vi-VN"}))]}),i.music?e.jsxs(o,{align:"start",size:4,children:[e.jsx("i",{className:"fa-solid fa-music"})," ",i.music]}):null]})]})}),[]);return e.jsx(Q,{collectionName:(n==null?void 0:n.name)+" - Reels",fetchNext:p,renderItem:d,downloadItem:c,getItemCursor:i=>i.cursor,rowKey:i=>i.id,searchPlaceholder:i=>a({en:`Seach in ${i==null?void 0:i.length} Reels`,vi:`Tìm kiếm trong ${i==null?void 0:i.length} Reels`}),onSearch:(i,s)=>M(i,s.description+s.music+z(s.created_time,a({en:"en-US",vi:"vi-VN"})))})}export{Ci as default};
