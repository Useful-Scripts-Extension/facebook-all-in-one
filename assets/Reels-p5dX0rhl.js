const __vite__fileDeps=["./ImageLazyPreview-C25eNRgF.js","./index-C0GZV8r4.js","./index-DfqnkV-X.css","./MyApp-5UuG5Alv.js","./index-DqYBXEs5.js","./addEventListener-D-0G3yIj.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as m,av as e,aw as A,aA as T}from"./index-C0GZV8r4.js";import{A as W,u as z,b as n,a7 as O,g as U,a8 as q,a6 as F,f as g,I as M}from"./MyApp-5UuG5Alv.js";import{C as _}from"./Collection-DFbTstJo.js";import{b as B}from"./index-irdfsVlN.js";import{V as Q}from"./VideoWithMuted-BYhYz8Pu.js";import{L as $}from"./index-ChuHj_qb.js";import{T as G}from"./index-CbZxyvQY.js";import"./index-Ca7rCt7M.js";import"./file-download-BJF8e5Y0.js";import"./index-BFuDaB_r.js";import"./Dropdown-B7RIYLpN.js";import"./PurePanel-DK31J58S.js";import"./index-DBY2_SRc.js";import"./index-5vdqXesG.js";import"./index-D8nKmtSx.js";import"./addEventListener-D-0G3yIj.js";import"./index-B5sA0xfq.js";import"./index-9AWtuJYp.js";import"./index-CRcIzT1K.js";import"./useBreakpoint-Bu9dHjAK.js";import"./index-CEX1fess.js";import"./index-CPOtpTXx.js";import"./index-CAxkHnSi.js";import"./index-DqYBXEs5.js";import"./index-D_rV-K7J.js";import"./Pagination-Bqljqj6K.js";import"./row-DKHVyfQS.js";async function H({id:o="",cursor:a=""}){var r,t,u;const p=await W({fb_api_req_friendly_name:"ProfileCometAppCollectionReelsRendererPaginationQuery",variables:{count:10,cursor:a,feedLocation:"COMET_MEDIA_VIEWER",feedbackSource:65,focusCommentID:null,renderLocation:null,scale:1,useDefaultActor:!0,id:btoa("app_collection:"+o+":168684841768375:260")},doc_id:"7821270511254925"}),c=JSON.parse(((r=p==null?void 0:p.split(`
`))==null?void 0:r[0])||"{}"),{edges:d=[],page_info:i={}}=((u=(t=c==null?void 0:c.data)==null?void 0:t.node)==null?void 0:u.aggregated_fb_shorts)||{};return d.map(l=>{var h,b,f,y,w,j,k,v,C,x,I,N,R,S,E,P,L,V;const s=((b=(h=l==null?void 0:l.profile_reel_node)==null?void 0:h.node)==null?void 0:b.short_form_video_context)||{};return{id:((w=(y=(f=l==null?void 0:l.profile_reel_node)==null?void 0:f.node)==null?void 0:y.video)==null?void 0:w.id)||atob((j=l==null?void 0:l.profile_reel_node)==null?void 0:j.id).split(":").pop(),created_time:(((v=(k=l==null?void 0:l.profile_reel_node)==null?void 0:k.node)==null?void 0:v.creation_time)||0)*1e3,description:(I=(x=(C=l==null?void 0:l.profile_reel_node)==null?void 0:C.node)==null?void 0:x.message)==null?void 0:I.text,viewCount:s==null?void 0:s.play_count_reduced,source:((N=s==null?void 0:s.playback_video)==null?void 0:N.browser_native_hd_url)||((R=s==null?void 0:s.playback_video)==null?void 0:R.browser_native_sd_url),height:(S=s==null?void 0:s.playback_video)==null?void 0:S.height,width:(E=s==null?void 0:s.playback_video)==null?void 0:E.width,thumbnail:(L=(P=s==null?void 0:s.playback_video)==null?void 0:P.image)==null?void 0:L.uri,url:s==null?void 0:s.shareable_url,length:(V=s==null?void 0:s.playback_video)==null?void 0:V.length_in_second,cursor:(l==null?void 0:l.cursor)||i.end_cursor,music:s==null?void 0:s.track_title}})}const J=m.lazy(()=>T(()=>import("./ImageLazyPreview-C25eNRgF.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url));function Ci({target:o}){const{ti:a}=z(),p=m.useCallback(async(i=[],r)=>{var u;return!(o!=null&&o.id)||!(o!=null&&o.type)?void 0:(r=r||((u=i==null?void 0:i[(i==null?void 0:i.length)-1])==null?void 0:u.cursor)||"",await H({id:o.id,cursor:r}))},[o]),c=m.useCallback(async i=>({url:i.source,name:i.id+".mp4"}),[]),d=m.useCallback(i=>e.jsx($.Item,{children:e.jsxs(n,{direction:"vertical",children:[e.jsxs("div",{className:"show-on-hover-trigger",children:[e.jsx(J,{src:i.thumbnail,width:200,height:300,style:{objectFit:"cover"},cacheId:"reels."+i.id,getPreview:()=>i.source||B(i.id).then(r=>(console.log(r),r.source)),renderPreview:(r,t)=>({destroyOnClose:!0,imageRender:()=>e.jsx(O,{spinning:t,children:e.jsx(Q,{src:r,style:{maxWidth:"90vw",maxHeight:"90vh"}})}),toolbarRender:()=>null})}),e.jsx(A,{type:"default",icon:e.jsx("i",{className:"fa-solid fa-up-right-from-square"}),style:{position:"absolute",bottom:10,right:10},className:"show-on-hover-item",target:"_blank",href:U(i.id)})]}),e.jsx(G.Paragraph,{style:{maxWidth:"150px",wordWrap:"break-word"},onClick:()=>window.open(i.url),children:q(i.description,100)}),e.jsxs(n,{direction:"vertical",size:1,style:{position:"absolute",top:0,left:0,padding:10,paddingBottom:50,width:"100%",background:"linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%)",pointerEvents:"none"},children:[e.jsxs(n,{children:[e.jsx("i",{className:"fa-regular fa-eye"}),i.viewCount]}),e.jsxs(n,{children:[e.jsx("i",{className:"fa-solid fa-film"}),i.length?F(i.length):null]}),e.jsxs(n,{children:[e.jsx("i",{className:"fa-regular fa-clock"}),g(i.created_time,a({en:"en-US",vi:"vi-VN"}))]}),i.music?e.jsxs(n,{align:"start",size:4,children:[e.jsx("i",{className:"fa-solid fa-music"})," ",i.music]}):null]})]})}),[]);return e.jsx(_,{collectionName:(o==null?void 0:o.name)+" - Reels",fetchNext:p,renderItem:d,downloadItem:c,getItemCursor:i=>i.cursor,rowKey:i=>i.id,searchPlaceholder:i=>a({en:`Seach in ${i==null?void 0:i.length} Reels`,vi:`Tìm kiếm trong ${i==null?void 0:i.length} Reels`}),onSearch:(i,r)=>M(i,r.description+r.music+g(r.created_time,a({en:"en-US",vi:"vi-VN"})))})}export{Ci as default};
