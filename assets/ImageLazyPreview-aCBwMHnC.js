import{aj as L,r as g,ao as h}from"./index-DB0Mkjis.js";import{a as k,q as x,w as C}from"./MyApp-CjW7GEY5.js";import{I}from"./index-UmZ1EKUw.js";import"./addEventListener-BrHl9dJj.js";function z(m){const{cacheId:p,getPreview:d,renderPreview:s,...t}=m,{message:n}=L.useApp(),{ti:c}=k(),r=t.src||"",o="ImageLazyPreview."+(p||r),[y,i]=g.useState(!1),[l,u]=g.useState(x(o,"")),w=async()=>{if(!l)try{i(!0),n.loading({duration:0,key:o,content:c({en:"Loading...",vi:"Đang tải..."})});let a=performance.now();const e=await d();let v=performance.now();console.log("getPreview",v-a),e&&e!==r&&(u(e),C(o,e)),n.destroy(o)}catch(a){console.error(a),n.error({key:o,content:c({en:"Load failed: ",vi:"Load lỗi: "})+a.message})}finally{i(!1)}},f=l||r;return h.jsx(I,{...t,preview:typeof s=="function"?s(f,y):{src:f},onClick:a=>{var e;(e=t.onClick)==null||e.call(t,a),w()}})}export{z as default};
