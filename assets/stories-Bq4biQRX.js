import{p as C,U as g,q as tt,a8 as nt}from"./MyApp-DltFDv_V.js";async function st(i=""){const e=await C({fb_api_req_friendly_name:"StoriesTrayRectangularQuery",variables:{blur:10,bucketsToFetch:5,cursor:i,scale:1,id:await g()},doc_id:"24539171939059864"}),c=JSON.parse(e);console.log(c);const{edges:_=[],page_info:l={}}=tt(c);return _.map(r=>{var f,y,n,o,t,a,p,I,S,D,L,k;const s=((f=r==null?void 0:r.node)==null?void 0:f.story_bucket_owner)||{};return{bucket_id:(y=r==null?void 0:r.node)==null?void 0:y.id,thumbnail:(a=(t=(o=(n=r==null?void 0:r.node)==null?void 0:n.thumbnail_story_to_show)==null?void 0:o.story_card_info)==null?void 0:t.story_thumbnail)==null?void 0:a.uri,owner:{id:s.id,name:s.name,avatar:((p=s.coverImage)==null?void 0:p.uri)||((I=s.profilePic)==null?void 0:I.uri)||((S=s.profile_picture)==null?void 0:S.uri)},stories:(k=(L=(D=r==null?void 0:r.node)==null?void 0:D.unified_stories)==null?void 0:L.edges)==null?void 0:k.map(v=>{var A,M;return{id:(A=v==null?void 0:v.node)==null?void 0:A.id,expiration_time:(M=v==null?void 0:v.node)==null?void 0:M.expiration_time}}),cursor:(r==null?void 0:r.cursor)||l.end_cursor}}).filter(r=>r.stories.length>0)}async function at(i=""){var l,r,s,f,y;const e=await C({fb_api_req_friendly_name:"StoriesSuspenseContentPaneRootWithEntryPointQuery",variables:{blur:10,bucketID:i,feedbackSource:65,feedLocation:"COMET_MEDIA_VIEWER",focusCommentID:null,initialBucketID:i,initialLoad:!1,scale:1,shouldDeferLoad:!1,shouldEnableArmadilloStoryReply:!0,shouldEnableLiveInStories:!0,__relay_internal__pv__StoriesIsShareToStoryEnabledrelayprovider:!1,__relay_internal__pv__StoriesLWRVariantrelayprovider:"www_new_reactions"},doc_id:"8237681579610775"}),c=JSON.parse((e==null?void 0:e.split(`
`)[0])||"{}");console.log(c);const _=((r=(l=c==null?void 0:c.data)==null?void 0:l.nodes)==null?void 0:r[0])||((s=c==null?void 0:c.data)==null?void 0:s.bucket);return(y=(f=_==null?void 0:_.unified_stories)==null?void 0:f.edges)==null?void 0:y.map(n=>{var p,I,S,D,L,k,v,A,M,q,J,N,T,P,W,Q,G,U,Y,B,F,H,z,K,X,Z,$,u,b,h,m,w,O,V,R;const o=((S=(I=(p=n==null?void 0:n.node)==null?void 0:p.attachments)==null?void 0:I[0])==null?void 0:S.media)||{},t=((L=(D=n==null?void 0:n.node)==null?void 0:D.story_card_info)==null?void 0:L.feedback_summary)||{},a=[];for(let x of((A=(v=(k=n==null?void 0:n.node)==null?void 0:k.story_card_info)==null?void 0:v.viewerList_viewers)==null?void 0:A.edges)||[])for(let E of((M=x==null?void 0:x.feedback)==null?void 0:M.lightweight_reactions)||[]){let j=(J=(q=E==null?void 0:E.id)==null?void 0:q.split(":"))==null?void 0:J[0],ot="";for(let d of((N=E==null?void 0:E.last5)==null?void 0:N.edges)||[])ot+=(T=d==null?void 0:d.node)==null?void 0:T.reaction;a.push({uid:j,reaction:ot})}return{bucket_id:i,id:(P=n==null?void 0:n.node)==null?void 0:P.id,caption:((Q=(W=n==null?void 0:n.node)==null?void 0:W.message)==null?void 0:Q.text)||((G=o==null?void 0:o.message)==null?void 0:G.text)||((U=o==null?void 0:o.title)==null?void 0:U.text),thumbnail:((F=(B=(Y=n==null?void 0:n.node)==null?void 0:Y.story_card_info)==null?void 0:B.story_thumbnail)==null?void 0:F.uri)||((H=o==null?void 0:o.previewImage)==null?void 0:H.uri),url:(K=(z=n==null?void 0:n.node)==null?void 0:z.shareable)==null?void 0:K.url,video:(o==null?void 0:o.playable_url_quality_hd)||(o==null?void 0:o.browser_native_hd_url)||(o==null?void 0:o.playable_url)||(o==null?void 0:o.browser_native_sd_url),image:((X=o==null?void 0:o.image)==null?void 0:X.uri)||((Z=o==null?void 0:o.previewImage)==null?void 0:Z.uri),reaction:(u=($=t==null?void 0:t.reaction_summary)==null?void 0:$.map(x=>x.reaction_unicode))==null?void 0:u.join(""),react_count:t==null?void 0:t.total_reaction_count,view_count:((m=(h=(b=n==null?void 0:n.node)==null?void 0:b.story_card_info)==null?void 0:h.story_viewers)==null?void 0:m.count)||((V=(O=(w=n==null?void 0:n.node)==null?void 0:w.story_card_info)==null?void 0:O.viewers)==null?void 0:V.count),creation_time:(R=n==null?void 0:n.node)==null?void 0:R.creation_time,reactions:a}})}async function ct(i=""){const e=await C({doc_id:"2474284976008135",variables:{count:8,cursor:i,scale:1.5,id:btoa("app_collection:"+await g()+":235134840312703:175")}}),c=JSON.parse(e);console.log(c);const{edges:_=[],page_info:l={}}=tt(c)||{};return _.map(r=>{var f,y,n,o,t,a;const s=((f=r==null?void 0:r.node)==null?void 0:f.node)||(r==null?void 0:r.node);return{id:s==null?void 0:s.id,creation_time:(y=s==null?void 0:s.story_card_info)==null?void 0:y.local_creation_time,thumbnail:(o=(n=s==null?void 0:s.story_card_info)==null?void 0:n.story_thumbnail)==null?void 0:o.uri,seen_count:(a=(t=s==null?void 0:s.story_card_seen_state)==null?void 0:t.seen_count)==null?void 0:a.count,cursor:(r==null?void 0:r.cursor)||l.end_cursor}})}async function _t({afterTime:i="",beforeTime:e="",creationTime:c=""}={}){var f,y,n,o;if(c){const t=new Date(c),a=new Date(t.getTime()+24*60*60*1e3);i=nt(t),e=nt(a)}console.log(i,e);const _=await C({fb_api_req_friendly_name:"StoriesArchiveContentPaneRootQuery",variables:{lower_bound_time:i,upper_bound_time:e,scale:1,blur:null,shouldEnableLiveInStories:!0,feedbackSource:65,useDefaultActor:!1,feedLocation:"COMET_MEDIA_VIEWER",focusCommentID:null,isStoriesArchive:!0,__relay_internal__pv__StoriesIsShareToStoryEnabledrelayprovider:!1},doc_id:"8266171723403755"}),l=JSON.parse(_.split(`
`)[0]||"{}");console.log(l);const{edges:r=[],page_info:s={}}=((o=(n=(y=(f=l==null?void 0:l.data)==null?void 0:f.viewer)==null?void 0:y.stories_data)==null?void 0:n.story_archive)==null?void 0:o.cards)||{};return r.map(t=>{var k,v,A,M,q,J,N,T,P,W,Q,G,U,Y,B,F,H,z,K,X,Z,$;const a=((k=t==null?void 0:t.node)==null?void 0:k.viewerCount)||{},p=(A=(v=t==null?void 0:t.node)==null?void 0:v.media_attribution_elements)==null?void 0:A.find(u=>u.attribution_type==="MUSIC");function I(u){var b,h;return(h=(b=t==null?void 0:t.node)==null?void 0:b.attachments)==null?void 0:h.find(m=>{var w;return((w=m==null?void 0:m.media)==null?void 0:w.__typename)===u})}function S(u){return["image","previewImage","blurred_image"].reduce((b,h)=>{var m,w;return b||((w=(m=u==null?void 0:u.media)==null?void 0:m[h])==null?void 0:w.uri)},"")}let D="",L=I("GenericAttachmentMedia");return L?D=I("Photo"):L=I("Photo"),{id:(M=t==null?void 0:t.node)==null?void 0:M.id,created_at:(((q=t==null?void 0:t.node)==null?void 0:q.creation_time)||0)*1e3,last_seen_at:(((N=(J=t==null?void 0:t.node)==null?void 0:J.story_card_seen_state)==null?void 0:N.seen_receipts_last_seen_time)||0)*1e3,comment_count:(P=(T=t==null?void 0:t.node)==null?void 0:T.feedback)==null?void 0:P.story_comment_count,viewer_count:{friend:(W=a==null?void 0:a.friendViewerCount)==null?void 0:W.count,connection:(Q=a==null?void 0:a.connectionViewerCount)==null?void 0:Q.count,follower:(G=a==null?void 0:a.followerViewerCount)==null?void 0:G.count,new_friend:(U=a==null?void 0:a.newFriendViewerCount)==null?void 0:U.count,new_connection:(Y=a==null?void 0:a.newConnectionViewerCount)==null?void 0:Y.count},image:S(L),image_background:S(D),video:["browser_native_hd_url","browser_native_sd_url"].reduce((u,b)=>{var h,m,w,O;return u||((O=(w=(m=(h=t==null?void 0:t.node)==null?void 0:h.attachments)==null?void 0:m.find(V=>{var R;return(R=V==null?void 0:V.media)==null?void 0:R[b]}))==null?void 0:w.media)==null?void 0:O[b])},""),music:p?(p==null?void 0:p.song_title)+" - "+(p==null?void 0:p.artist_name):"",reactions:(z=(H=(F=(B=t==null?void 0:t.node)==null?void 0:B.story_card_info)==null?void 0:F.story_card_reactions)==null?void 0:H.edges)==null?void 0:z.map(u=>{var b,h,m,w,O,V,R;return{uid:(h=(b=u==null?void 0:u.node)==null?void 0:b.messaging_actor)==null?void 0:h.id,reactions:(O=(w=(m=u==null?void 0:u.node)==null?void 0:m.messaging_actions)==null?void 0:w.edges)==null?void 0:O.reduce((x,E)=>{var j;return x+((j=E==null?void 0:E.node)==null?void 0:j.reaction)},""),count:(R=(V=u==null?void 0:u.node)==null?void 0:V.messaging_actions)==null?void 0:R.count}}),viewers:($=(Z=(X=(K=t==null?void 0:t.node)==null?void 0:K.story_card_info)==null?void 0:X.viewerList_viewers)==null?void 0:Z.edges)==null?void 0:$.map(rt)}})}function rt(i){var e,c,_,l,r,s,f,y;return{uid:(e=i==null?void 0:i.node)==null?void 0:e.id,avatar:(_=(c=i==null?void 0:i.node)==null?void 0:c.profile_picture)==null?void 0:_.uri,name:(l=i==null?void 0:i.node)==null?void 0:l.name,reactions:(s=(r=i==null?void 0:i.feedback)==null?void 0:r.lightweight_reactions)==null?void 0:s.reduce((n,o)=>{var a,p;const t=((a=o==null?void 0:o.last5)==null?void 0:a.edges)||((p=o==null?void 0:o.messaging_actions)==null?void 0:p.edges);return n+(t==null?void 0:t.reduce((I,S)=>{var D;return I+((D=S==null?void 0:S.node)==null?void 0:D.reaction)},""))},""),count:(y=(f=i==null?void 0:i.feedback)==null?void 0:f.lightweight_reactions)==null?void 0:y.reduce((n,o)=>{var t;return n+((t=o==null?void 0:o.messaging_actions)==null?void 0:t.count)},0),seen_time:((i==null?void 0:i.seen_time)||0)*1e3,cursor:i==null?void 0:i.cursor}}async function lt({storyId:i="",cursor:e=""}={}){const c=await C({fb_api_req_friendly_name:"StoriesViewerSheetViewerListContentQuery",variables:{cursor:e,id:i,viewerCount:8},doc_id:"3934951263269875"}),_=JSON.parse(c.split(`
`)[0]||"{}");console.log(_);const{edges:l=[],page_info:r={}}=tt(_)||{};return l.map(rt)}async function ut(i=""){var l,r,s,f,y;const e=await C({variables:{scale:1,userID:i,useIncrementalDelivery:!0},doc_id:"4192155837522535"}),c=JSON.parse(e.split(`
`)[0]||"{}"),_=(f=(s=(r=(l=c==null?void 0:c.data)==null?void 0:l.user)==null?void 0:r.story_bucket)==null?void 0:s.nodes)==null?void 0:f[0];return console.log(c),{bucketId:_==null?void 0:_.id,firstStoryId:(y=_==null?void 0:_.first_story_to_show)==null?void 0:y.id}}async function et(i="",e=""){var l,r,s,f,y,n;const c=await C({fb_api_req_friendly_name:"useStoriesSendReplyMutation",variables:{input:{lightweight_reaction_actions:{offsets:[0],reaction:e},story_id:i,story_reply_type:"LIGHT_WEIGHT",actor_id:await g(),client_mutation_id:7}},doc_id:"3769885849805751"}),_=JSON.parse(c);return console.log(_),(n=(y=(f=(s=(r=(l=_==null?void 0:_.data)==null?void 0:l.direct_message_reply)==null?void 0:r.story)==null?void 0:s.story_card_info)==null?void 0:f.story_card_reactions)==null?void 0:y.edges)==null?void 0:n.length}export{at as a,lt as b,st as c,ct as d,_t as e,ut as g,et as r};
