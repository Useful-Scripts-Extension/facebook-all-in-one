import{ao as y,ap as R,r as n,aq as e,ar as u}from"./index-DK9VpK7Z.js";import{a as V,a1 as N,S as o,a2 as T,b as _}from"./MyApp-BHD6VW6n.js";import{S as I}from"./StoryViewers-BKpd2ySj.js";import{u as C}from"./useCacheState-B8xTfoxV.js";import{T as c}from"./index-CLcfezOx.js";import{I as F}from"./index-Cg-fKe13.js";import{A as L}from"./index-ZPvaunNs.js";import"./Collection-D_5id6rP.js";import"./index-ux3d5fbP.js";import"./file-download-DObqyEDW.js";import"./index-BjwtQS8J.js";import"./Dropdown-CDem9SrW.js";import"./PurePanel-F8yUCVM9.js";import"./index-Ch48yAb_.js";import"./TextArea-Dam_UsLU.js";import"./addEventListener-DnrojY7_.js";import"./index-DlqXPYre.js";import"./Pagination-DofX7tu3.js";import"./useBreakpoint-D3UHp-M0.js";import"./row-TMJJSMo1.js";import"./styleChecker-DFOfC8TH.js";function te({story:i}){const{ti:d}=V(),l=y(R.profile),[s,j]=C("RecentStoryViewer.buckets."+i.bucked_id,[]),[r,p]=n.useState(0),[x,f]=n.useState(!1),[g,w]=n.useState(!1),t=s[r]||s[0],v=r<s.length-1,b=r>0,k=s.length===0&&!x,S=i.owner.id===(l==null?void 0:l.uid),h=n.useRef(!1);n.useEffect(()=>{i.bucked_id&&!h.current&&(f(!0),h.current=!0,N(i.bucked_id).then(m=>{m&&(console.log(i,m),j(m))}).finally(()=>{h.current=!1,f(!1)}))},[]);const a={height:"70vh",width:"calc(70vh * 9 / 16)",borderRadius:10,objectFit:"contain"};return e.jsxs(o,{direction:"vertical",style:{maxHeight:"100vh",overflowY:"auto",overflowX:"hidden",minWidth:a.width,minHeight:a.height,background:"#222",padding:"10px 10px 30px",borderRadius:10,color:"white"},children:[e.jsxs(c.Text,{children:["Story Viewer (",r+1,"/",s.length,")"]}),x&&e.jsxs("div",{children:[e.jsx("i",{className:"fa fa-spinner fa-spin"})," Loading..."]}),k&&e.jsx("div",{children:"No data"}),t&&e.jsxs(o,{children:[e.jsx(u,{disabled:!b,onClick:()=>{p(r-1)},children:e.jsx("i",{className:"fa fa-chevron-left"})}),e.jsxs(o,{direction:"vertical",children:[e.jsxs(c.Text,{children:[T(t.creation_time*1e3,d)," ",d({vi:"trước",en:"ago"})," - ",t.react_count," reactions"," ",t.reaction]}),S?e.jsxs(u,{type:"default",onClick:()=>w(!g),children:[e.jsx("i",{className:"fa fa-eye"})," ",t.view_count," ",d({vi:"Lượt xem",en:"Views"})]}):null,t.caption&&e.jsx(c.Text,{children:t.caption}),g?e.jsx(o,{style:{width:450,height:a.height,overflowY:"auto",overflowX:"hidden"},direction:"vertical",children:e.jsx(I,{storyId:t.id})}):e.jsxs(o,{style:{position:"relative"},children:[t.video?e.jsx("video",{controls:!0,autoPlay:!0,loop:!0,src:t.video,style:a}):e.jsx(F,{src:t.image,fallback:t.thumbnail,style:a}),e.jsx(o,{style:{background:"linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%)",position:"absolute",top:0,left:0,padding:10,width:"100%",paddingBottom:"50px",borderRadius:10},children:e.jsxs(c.Link,{target:"_blank",href:_(i.owner.id),children:[e.jsx(L,{src:i.owner.avatar,size:40,style:{borderWidth:4,borderColor:"#0866FF",marginRight:10}}),e.jsx(c.Text,{style:{color:"#eee"},children:i.owner.name})]})})]})]}),e.jsx(u,{disabled:!v,onClick:()=>{p(r+1)},children:e.jsx("i",{className:"fa fa-chevron-right"})})]})]})}export{te as default};
